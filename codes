-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Key
if not _G.key or _G.key == "" then
    warn("[ JOPA ] ‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ Redeem Key / ‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏≤‡∏à‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö Script ‡∏°‡∏≤‡πÉ‡∏ô‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î")
    game.Players.LocalPlayer:Kick("[ JOPA ] ‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ Redeem Key / ‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏≤‡∏à‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö Script ‡∏°‡∏≤‡πÉ‡∏ô‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î")
    return
end

-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Webhook
if not _G.Setting or not _G.Setting.WebhookURL or _G.Setting.WebhookURL == "" then
    warn("[ JOPA ] ‡πÑ‡∏°‡πà‡∏û‡∏ö WebhookURL ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô _G.Setting.WebhookURL")
    return
end

-- ‡∏´‡∏≤ request function ‡∏ó‡∏µ‡πà executor ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö
local req = (syn and syn.request) or (http and http.request) or (fluxus and fluxus.request) or request
if not req then
    warn("[ JOPA ] ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á Webhook ‡πÑ‡∏î‡πâ (‡πÑ‡∏°‡πà‡∏û‡∏ö request function)")
    return
end

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡πÑ‡∏õ Discord
local HttpService = game:GetService("HttpService")
local function sendDiscord(data)
    local json = HttpService:JSONEncode(data)
    req({
        Url = _G.Setting.WebhookURL,
        Method = "POST",
        Headers = {["Content-Type"] = "application/json"},
        Body = json
    })
end

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
local function sendStatus()
    local player = game.Players.LocalPlayer
    local stats = player:FindFirstChild("leaderstats")

    local money = (stats and stats:FindFirstChild("Money")) and tostring(stats.Money.Value) or "N/A"
    local bank  = (stats and stats:FindFirstChild("Bank"))  and tostring(stats.Bank.Value)  or "N/A"
    local level = (stats and stats:FindFirstChild("Level")) and tostring(stats.Level.Value) or "N/A"

    local embed = {
        ["username"] = "[ JOPA ] BlockSpin Logger",
        ["embeds"] = {{
            ["title"] = "üìä Player Status",
            ["color"] = 65280,
            ["fields"] = {
                {["name"] = "üë§ User", ["value"] = player.Name, ["inline"] = true},
                {["name"] = "‚úÖ Status", ["value"] = "‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå", ["inline"] = true},
                {["name"] = "üí∞ Money", ["value"] = money, ["inline"] = true},
                {["name"] = "üè¶ Bank", ["value"] = bank, ["inline"] = true},
                {["name"] = "‚≠ê Level", ["value"] = level, ["inline"] = true},
            },
            ["thumbnail"] = {["url"] = "https://img2.pic.in.th/pic/file_000000007ca061f7a4998f8f14959e56-removebg-preview.png"},
            ["image"] = {["url"] = "https://img2.pic.in.th/pic/banner-jopa-studiodc27e67dee058684.gif"},
            ["footer"] = {["text"] = "‡πÄ‡∏ß‡∏•‡∏≤: " .. os.date("%Y-%m-%d %H:%M:%S")}
        }}
    }

    sendDiscord(embed)
end

-- ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å 10 ‡∏ô‡∏≤‡∏ó‡∏µ
while task.wait(600) do
    pcall(sendStatus)
end
